## **实验环境**

$Dais-CMX16^+$



## **实验内容**

1. 通用寄存器实验
2. 准双向I/O口实验
3. 地址总线组成实验



## **通用寄存器实验**

### **寄存器组写操作**

#### **目的寄存器写编码**

| 目标使能              |        | 通用寄存器目标编址 |       |            |          |
| ----------------- | ------ | --------- | ----- | ---------- | -------- |
| $K_{19}...K_{17}$ | $IR$   | $K_{16}$  | $K_6$ |            | **功能说明** |
| $o_2...o_0$       | $IR_1$ | $OP$      | $W$   | $T_4$      |          |
|                   | 0      | 0         | 0     | $\uparrow$ | CX字写     |
|                   | 0      | 0         | 1     | $\uparrow$ | CL偶字节写   |
| 000               | 0      | 1         | X     | $\uparrow$ | CH奇字节写   |
|                   | 1      | 0         | 0     | $\uparrow$ | DX字写     |
|                   | 1      | 0         | 1     | $\uparrow$ | DL偶字节写   |
|                   | 1      | 1         | X     | $\uparrow$ | DH奇字节写   |



#### **寄存器组写入**

> $K_{21}~(MWR)$ EM程序存储器写使能
>
> $K_{16}~(OP)$ 目标部件奇偶标志
>
> $K_2~(LDIR)$ IR指令寄存器写使能

1. 首先打开总线编码的IOR功能（利用 $K_6~(M)$ 确定总线字长）

   - CX地址：00
   - DX地址：02
   - LDIR与MWR置为0
2. 打入CX或DX地址到IR指令寄存器中
3. 关闭LDIR与MWR
4. $K_{19}...K_{17}=000$ 为CX字写操作
5. 写入数据

其中，我们可以利用 $K_6 (W)$ 来指定总线字长，从而可以实现寄存器组的字写入与字节写入。



### **寄存器组读操作**

#### **源寄存器读编码**

| 源编码            |       | 通用寄存器源地址 |       |          |
| :------------- | :---- | :------- | :---- | :------- |
| $K_{10}...K_8$ | $IR$  | $K_7$    | $K_6$ | **功能说明** |
| $X_2...X_0$    | $IR1$ | $XP$     | $W$   |          |
|                | 0     | 0        | 0     | CX字读     |
|                | 0     | 0        | 1     | CL偶字节读   |
| 001            | 0     | 1        | X     | CH奇字节读   |
|                | 1     | 0        | 0     | DX字读     |
|                | 1     | 0        | 1     | DL偶字节读   |
|                | 1     | 1        | X     | DH奇字节读   |



#### **寄存器组读取**

1. 打开总线编码IOR功能
2. LDIR、MWR、OP置0，IR可写
3. 打入CX或DX地址到IR，以便于读取
4. 关闭LDIR与MWR
5. 总线功能选择RRD ( $K_{10}...K_6=001$ )

在寄存器组读取过程中，我们可以通过改变 $K_6$ 来控制是字读操作还是字节读操作，如果处于字节操作中，利用 $K_7$ 可选择CL 与 CH，从而可以分别传输寄存器高位与地位内容到总线中。



### **问题**

- 打入IR指令寄存器的CX与DX地址00与02是否是在出厂时规定好的数据
- 如果打入的地址是其他数据为什么也可以选择到CX寄存器



## **准双向I/O口实验**

### **I/O写操作**

#### **数据来源FUN**

> $K_{10}...K_6=11000$ 其中 $K_{10}...K_8=110$ 指总线选择ALU
>
> $K_7...K_6=00$ 即 $XP=0$ 与 $W=0$ 打开IO字写操作



#### **AX取反送数据总线**
> $K_{15}...K_{11}=11001$
>
> $K_{15}=1$ ALU进行逻辑运算
>
> $K_{13}...K_{11}=001$ 即 $S_2...S_0=001$ 进行的逻辑运算为 $\neg A$



#### **IO写选通**
> $K_{19}...K_{16}=0100$
>
> $K_{19}$ RXW(寄存器写使能)
>
> $K_{18}$ DI(目标寄存器编址)
>
> $K_{17}$ IOW(I/O写使能)
>
> $K_{16}$ 目的奇偶位



### **I/O读操作**
1. 总线源编码 $K_{10}...K_{8}=100$ 选择IOR功能
2. $W=0~P=0$ IO字写
3. $K_{19}...K_{16}=1010$ BX写选通并打入一条数据到BX
4. 关闭写选通，总线编码选择ALU，并使ALU输出BX的值( $M=1~S_2...S_0=000$ )





### **有关I/O字节读写操作**
I/O口的写操作只能在当前状态为全F时写入，因为输入和输出同时只能有一个有效，或者另一种方法是I/O口高八位输出，低八位输入，相反也可行。



## **地址总线组成实验**

### **程序计数器实验**

*操作对象：PC*

| 目标部件定义 |      | 节拍         | 功能说明    |
| :----- | ---- | ---------- | ------- |
| E/M    | IP   | T3上升沿打入    | T3上升沿打入 |
| 1      | 1    | X          | PC保持    |
| 1      | 0    | $\uparrow$ | PC加1    |
| 0      | 0    | $\uparrow$ | PC装载    |



#### **实验流程**

1. 打开IOR功能，IO字写
2. 打开 $LDPC(K_{22})$ PC程序计数器更新位
3. 打开 $E/M(K_{23})$ 当IP有效时，E/M：0=PC装载，1=PC加1
4. 置数并给一个上升沿打入
5. 总线编码 $X_2...X_0=000$ 选择PC，DBUS即为PC的值





### **地址寄存器与堆栈寄存器实验**

*操作对象：AR或SP*



#### **实验流程**

1. 打开IOR功能，IO字写
2. 地址寄存器：目的编码选择MAR，偶寻址
3. 堆栈寄存器：目的编码选择SP，偶寻址
4. 置数并给其一个上升沿打入



## **总结**

虽然照着实验指导书上可以完成相关的操作，并且根据前面的内容与注释可以看懂当前操作的目的，但是在整个设备中还有好多好多没有接触到的部分，现在只是学到了局部的一些概念，想要哪天去完成一件完整的有意义的设计还需要很长时间去学习！